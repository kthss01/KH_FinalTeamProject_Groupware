# âœ”ï¸ ëŒ€ëŒ“ê¸€ ì¡°íšŒ ê¸°ëŠ¥

**ì²«ë²ˆì§¸ ajaxí†µì‹ ìœ¼ë¡œ ë¶€ëª¨ ëŒ“ê¸€ë“¤ì„ ì¡°íšŒí•´ì„œ í™”ë©´ì— ë¿Œë ¤ì¤€ë‹¤. *ë¶€ëª¨ ëŒ“ê¸€ ë§ˆë‹¤ í•¨ìˆ˜ë¥¼  í˜¸ì¶œí•˜ì—¬ 2ì°¨ ajax í†µì‹ ì„ í†µí•´* í•´ë‹¹ ëŒ“ê¸€ì˜ ë²ˆí˜¸ë¥¼ ë¶€ëª¨ë²ˆí˜¸ë¡œ ê°€ì§€ê³  ìˆëŠ” ìì‹ ëŒ“ê¸€ë“¤ì„ 2ì°¨ë¡œ ê·¸ ì•„ë˜ì— ë¶™ì—¬ì¤€ë‹¤.**  

## <JSP>

### âœ”ï¸ eventDetailView.java

	**`selectNestedList(cm.cNum);`	 â†’ ëŒ“ê¸€ ë§ˆë‹¤ ì‹¤í–‰ â†’ 2ì°¨ í†µì‹ **

```jsx
$.ajax({
			url:'commentList.ev',
			type: 'get',
			async:false,
			data : { eno : eno},
			success : function(list){

				list.forEach((cm => {
					console.log(cm);

					commentBox.append(`
							<br>
							<b>ì‘ì„±ì : </b> \${cm.name} 
							<br>
							
							<textarea name="comment" class="comment"  maxlength="1000" disabled> \${cm.comment}</textarea>
							<input type="button" class ="nestedComment" value="ë‹µê¸€">

									<input type="button" class="updateBtn" value="ìˆ˜ì •">
									<input type="button" class="deleteBtn" value="ì‚­ì œ" >
									<input type="hidden" name="cNum" value=\${cm.cNum}>
	
							`)	
						**selectNestedList(cm.cNum); //í•´ë‹¹ ëŒ“ê¸€ì˜ ë²ˆí˜¸ë¥¼ ì¸ìë¡œ ë„˜ê¹€.**							
				}
				));
```

## â™£ï¸ SQL

*`cm.cNum`ìœ¼ë¡œ ë„˜ê¸´ ëŒ“ê¸€ ë²ˆí˜¸ëŠ” **Controller**ì— ì „ë‹¬ ëœë‹¤.*

```sql
SELECT 
B.USER_NAME,
.* 
FROM E_COMMENT A 
LEFT JOIN USER_TB B ON A.C_ID = B.EMAIL_ID
WHERE A.C_PARENT=? 
ORDER BY A.C_DATE ASC";
```

### ğŸŒŸ f**unction** `selectNestedList(cm.cNum)`

```jsx
function selectNestedList(pNo){
					**//ë¶€ëª¨ ëŒ“ê¸€ ë²ˆí˜¸**
					console.log("ë¶€ëª¨ëŒ“ê¸€ë²ˆí˜¸ : " + **pNo**); ë¡œ ìì‹ ì¡°íšŒ.
					$.ajax({
						url : 'nestedCommentList.ev',
						type : 'post',
						async:false,
						dataType :'json',
						data : {
							cno : pNo
						},
						success :  function(list){
							list.forEach((cm => {
								commentBox.append(`
										<div class="nestedreplyBox" style="margin-left:50px;">
										<br>
										ã„´> <b>ì‘ì„±ì : </b> \${cm.name} 
										<br>
										<textarea name="comment" class="comment"  maxlength="1000" disabled> \${cm.comment}</textarea>
										<input type="button" class ="nestedComment" value="ë‹µê¸€">

												<input type="button" class="updateBtn" value="ìˆ˜ì •">
												<input type="button" class="deleteBtn" value="ì‚­ì œ" >
												<input type="hidden" name="cNum" value=\${cm.cNum}>										
										</div>
										`)													
							}))							
						},
						error : function(e,e2){
							console.log("í†µì‹ ì‹¤íŒ¨")
							console.log(e2);
						}
						
					})
				}
```

### âœ”ï¸ NastedCommentListServlet.java

**nastedCommentList.ev**

```java
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		
		int cno = Integer.parseInt(request.getParameter("cno"));
		System.out.println("ë¶€ëª¨ëŒ“ê¸€ë²ˆí˜¸ :" + cno);
		ArrayList<EventComment> list = new EventService().nestedCommentList(cno);
		
		JSONArray jArr = new JSONArray();
		JSONObject jObj = null;
		
		for(EventComment ec : list) {	
			jObj = new JSONObject();

			jObj.put("cNum", ec.getcNum());
			jObj.put("eNo", ec.geteNo());
			jObj.put("name",ec.getName());
			jObj.put("emailId", ec.getEmailId());
			jObj.put("ePwd", ec.getePwd());
			jObj.put("cDate", ec.getcDate()+"");
			jObj.put("cParent", ec.getcParent());
			jObj.put("comment", ec.getComment());
			
			jArr.add(jObj);
		}
		
		System.out.println("jArr : " + jArr);
		//ë¸Œë¼ìš°ì €ë¡œ jsonê°ì²´ë¥¼ ì „ì†¡
		response.setContentType("application/json; charset=utf-8");
		response.getWriter().print(jArr);
	
	}
```

### ğŸ”´CHECK POINT

AJAXëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ í†µì‹ ì„ í•˜ëŠ”ë° ì´ë¥¼ ë™ê¸°ì‹ìœ¼ë¡œ ì§„í–‰í•˜ê³  ì‹¶ì„ ê²½ìš°ì—ëŠ” ì†ì„±ì— **async : false** ì²˜ë¦¬ë¥¼ í•´ì£¼ëŠ” ë°©ë²•ì´ ìˆë‹¤.

- **< ë™ê¸°ì™€ ë¹„ë™ê¸°ë°©ì‹ì˜ ì°¨ì´ì  >**
    
    ## ë™ê¸°(Synchronous)
    
    **ë™ê¸°ëŠ” ìš”ì²­ì„ ë³´ë‚¸ í›„ ì‘ë‹µ(ê²°ê³¼ë¬¼)ì„ ë°›ê³  ë‹¤ìŒ ë™ì‘ì´ ì´ë£¨ì–´ì§€ëŠ” ë°©ì‹**ì´ë‹¤.
    ëª¨ë“  ì¼ì€ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©° ì–´ë–¤ ì‘ì—…ì´ ìˆ˜í–‰ì¤‘ì´ë¼ë©´ ê·¸ ë‹¤ìŒ ì‘ì—…ì€ ëŒ€ê¸°í•œë‹¤.
    
    ## ë¹„ë™ê¸°(Asynchronous)
    
    - ë¹„ë™ê¸° ì²˜ë¦¬ê°€ í•„ìš”í•œ ì´ìœ  ?
    
     ë°ì´í„°ë¥¼ ì„œë²„ë¡œë¶€í„° ë°›ì•„ì˜¤ëŠ” ì•±ì„ ë§Œë“ ë‹¤ê³  ê°€ì •í•˜ë©´, ì„œë²„ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì•„ì™€ì„œ
    í•´ë‹¹ ë°ì´í„°ë¥¼ ë¿Œë ¤ì¤˜ì•¼ í•˜ë¯€ë¡œ ë§¨ ì²˜ìŒì— ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ìœ„ì¹˜í•´ì•¼ í•œë‹¤.
    
     ë°ì´í„°ë¥¼ ë‹¤ ë°›ì•„ì˜¤ê¸° ì „ê¹Œì§€ ë‹¤ë¥¸ ì‘ì—…ë“¤ì€ ìˆ˜í–‰í•  ìˆ˜ ì—†ê³ , ë°ì´í„°ì˜ ì–‘ì´ ë§ì•„ì§ˆìˆ˜ë¡
    ì•±ì˜ ì‹¤í–‰ì†ë„ëŠ” ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ëŠë ¤ì§ˆ ê²ƒì´ë‹¤.
    
    ì´ëŠ” ìƒë‹¹íˆ ë¹„íš¨ìœ¨ì ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.
    
    ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë™ì•ˆ ì•±ì´ ëŒ€ê¸°í•˜ëŠ” ì‹œê°„ì„ ì¤„ì´ê³  í˜ì´ì§€ë¥¼ í‘œì‹œí•˜ëŠ” ì¼ê³¼ ë°ì´í„°ë¥¼
    ê°€ì ¸ì˜¤ëŠ” ì¼ì„ ë³„ë„ë¡œ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì˜³ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.
    
    ë¹„ë™ê¸° ì²˜ë¦¬ì˜ ëŒ€í‘œì ì¸ ì˜ˆ : setTimeout , Ajax
    

**ìì‹ ëŒ“ê¸€ì€ ë¶€ëª¨ ëŒ“ê¸€ 1ê°œë§ˆë‹¤ ì¡°íšŒë˜ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ì§„í–‰í•˜ë©´ ì•„ë˜ ê²°ê³¼ê°€ ëœë‹¤.**

ë¶€ëª¨ëŒ“ê¸€ê³¼ì˜ ê´€ê³„ëŠ” ìƒê´€ì—†ì´ ë¬´ì°¨ë³„ì ìœ¼ë¡œ ë¿Œë ¤ì§„ë‹¤. ì•„ë§ˆ ì¡´ì¬í•˜ëŠ” ëŒ“ê¸€ì´ ë§ì•˜ë‹¤ë©´ ì¢€ë” í™•ì—°í•˜ê²Œ ì°¨ì´ì ì´ ë³´ì˜€ì„ ê²ƒ ê°™ë‹¤. 

ì´ë¥¼ í•´ê²°í•˜ë ¤ë©´ ìì‹ ëŒ“ê¸€ì—ê²Œ  **async : false** ì²˜ë¦¬ë¥¼ í•´ì£¼ê³  ìš”ì²­ì´ ìˆì„ ë•Œì—ë§Œ í†µì‹ ì„ í•˜ë„ë¡ í•˜ë©´ ëœë‹¤!

### âœ”ï¸ë¹„ë™ê¸° ë°©ì‹

*ë¶€ëª¨ì™€ ìì‹ì´ ë”°ë¡œ ë†€ê²Œ ëœë‹¤.*

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6418e427-d58f-45ac-9f78-5191525c4e59/Untitled.png)

### âœ”ï¸ë™ê¸° ë°©ì‹

*ë™ê¸° ì²˜ë¦¬ë¡œ ìˆœì„œë¥¼ í™•ì‹¤íˆ í•´ì£¼ë‹ˆ ì •ìƒì ìœ¼ë¡œ ìê¸° ìë¦¬ì— ë¿Œë ¤ì§„ë‹¤.*

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/eb5d9f86-af8a-4266-9fd7-1c22a3235de9/Untitled.png)

# ğŸ”¥ ë§ˆë¬´ë¦¬

> ***ì´ì „ì— ë¯¸ë¦¬ ajaxë¥¼ ê²½í—˜í•˜ê³  ì •ë¦¬í•´ë‘” ë•ë¶„ì— ê°€ì¥ ê±±ì •í–ˆë˜ ì¡°íšŒ ë¶€ë¶„ì—ì„œ ë§ì´ í—¤ë§¤ì§€ ì•Šì•„ ë‹¤í–‰ì¸ ê²ƒ ê°™ë‹¤.***
> 
> 
> ***ì•„ì‰¬ìš´ ì ì€ ìµëª…ìœ ì €ì˜ ìˆ˜ì •,ì‚­ì œ ë°©ì‹ ë¯¸êµ¬í˜„ê³¼ ë¬´í•œ ëŒ“ê¸€ë¡œëŠ” ì—°ì¥í•˜ì§€ ëª»í–ˆë‹¤ëŠ” ê²ƒì¸ë° ë§¤ ì„¸ëŒ€ë§ˆë‹¤ ajax í†µì‹ ì„ í•´ì„œ ë¶ˆëŸ¬ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì„¸ëŒ€ë¥¼ ëŠ˜ë¦¬ëŠ” ë°ì—ëŠ” í•œê³„ê°€ ìˆë‹¤.***  
> 
> ***ìì‹ ì„¸ëŒ€ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë¥¼ ì¬ì‚¬ìš©í•´ë³´ë ¤ ê°€ë³ê²Œ ì‹œë„í•´ë³´ë ¤ë‹¤ê°€ ë¬´í•œ ì½œë°± í˜„ìƒì´ ë°œìƒí•´ì„œ ì¢€ ë” ì—°êµ¬ë¥¼ í•´ë³´ì•„ì•¼ í• í…ë° ì•„ì‰½ê²Œë„ ê±°ê¸°ê¹Œì§€ ì§„í–‰í•˜ê¸°ì—ëŠ” í˜„ì¬ ê¸‰í•œì¼ì´ ë” ë§ê³  ë„ˆë¬´ë‚˜ë„ ë°”ì˜ë‹¤ ã… ã… ***
> 
> ***ë‹¤ìŒ í”„ë¡œì íŠ¸ ë•Œ ëŒ“ê¸€ê¸°ëŠ¥ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤ë©´ ê·¸ ë•Œ ë‹¤ì‹œ ë„ì „í•´ë³´ê¸°ëŸ¬ í•˜ê³  ì´ì¯¤ì—ì„œ ë§ˆì¹˜ë„ë¡ í•˜ì.***
>
